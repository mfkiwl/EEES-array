INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/arch_config
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)
INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/utils
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)
INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/trace
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)
INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/simulation
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)
INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/rtl_gen
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)
INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/rtl_tools
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)
INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/solver_fpga
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)
INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/solver_program
  DESTINATION lib/solver/python
  PATTERN *.pyc EXCLUDE)

SET(SOLVER_CC_SRC
  ${CMAKE_CURRENT_SOURCE_DIR}/tool_driver/solver_cc_driver.py)
SET(SOLVER_CC_DST ${SIMD-TOOLCHAIN_BINARY_DIR}/bin/s-cc)

SET(SOLVER_RUN_SIM_SRC
  ${CMAKE_CURRENT_SOURCE_DIR}/tool_driver/solver_sim_driver.py)
SET(SOLVER_RUN_SIM_DST ${SIMD-TOOLCHAIN_BINARY_DIR}/bin/s-run-sim)

SET(SOLVER_RTL_GEN_SRC
  ${CMAKE_CURRENT_SOURCE_DIR}/tool_driver/solver_rtl_gen_driver.py)
SET(SOLVER_RTL_GEN_DST ${SIMD-TOOLCHAIN_BINARY_DIR}/bin/s-rtl-gen)

SET(SOLVER_READ_BIN_SRC
  ${CMAKE_CURRENT_SOURCE_DIR}/tool_driver/solver_read_bin.py)
SET(SOLVER_READ_BIN_DST ${SIMD-TOOLCHAIN_BINARY_DIR}/bin/s-read-bin)

SET(SOLVER_DBG_SRC
  ${CMAKE_CURRENT_SOURCE_DIR}/tool_driver/solver_dbg_driver.py)
SET(SOLVER_DBG_DST ${SIMD-TOOLCHAIN_BINARY_DIR}/bin/s-dbg)

SET(SOLVER_ASM_GEN_SRC
  ${CMAKE_CURRENT_SOURCE_DIR}/tool_driver/solver_asm_gen_driver.py)
SET(SOLVER_ASM_GEN_DST ${SIMD-TOOLCHAIN_BINARY_DIR}/bin/s-as-gen)

ADD_CUSTOM_COMMAND(
  OUTPUT  ${SOLVER_CC_DST}
  COMMAND ${CMAKE_COMMAND}
  ARGS    -E copy_if_different ${SOLVER_CC_SRC} ${SOLVER_CC_DST}
  DEPENDS ${SOLVER_CC_SRC}
  COMMENT "Creating compiler driver s-cc"
  )

ADD_CUSTOM_COMMAND(
  OUTPUT  ${SOLVER_RUN_SIM_DST}
  COMMAND ${CMAKE_COMMAND}
  ARGS    -E copy_if_different ${SOLVER_RUN_SIM_SRC} ${SOLVER_RUN_SIM_DST}
  DEPENDS ${SOLVER_RUN_SIM_SRC}
  COMMENT "Creating simulation driver s-run-sim"
  )

ADD_CUSTOM_COMMAND(
  OUTPUT  ${SOLVER_RTL_GEN_DST}
  COMMAND ${CMAKE_COMMAND}
  ARGS    -E copy_if_different ${SOLVER_RTL_GEN_SRC} ${SOLVER_RTL_GEN_DST}
  DEPENDS ${SOLVER_RTL_GEN_SRC}
  COMMENT "Creating RTL generator driver s-rtl-gen"
  )

ADD_CUSTOM_COMMAND(
  OUTPUT  ${SOLVER_READ_BIN_DST}
  COMMAND ${CMAKE_COMMAND}
  ARGS    -E copy_if_different ${SOLVER_READ_BIN_SRC} ${SOLVER_READ_BIN_DST}
  DEPENDS ${SOLVER_READ_BIN_SRC}
  COMMENT "Creating tool s-read-bin"
  )

ADD_CUSTOM_COMMAND(
  OUTPUT  ${SOLVER_DBG_DST}
  COMMAND ${CMAKE_COMMAND}
  ARGS    -E copy_if_different ${SOLVER_DBG_SRC} ${SOLVER_DBG_DST}
  DEPENDS ${SOLVER_DBG_SRC}
  COMMENT "Creating tool s-dbg"
  )

ADD_CUSTOM_COMMAND(
  OUTPUT  ${SOLVER_ASM_GEN_DST}
  COMMAND ${CMAKE_COMMAND}
  ARGS    -E copy_if_different ${SOLVER_ASM_GEN_SRC} ${SOLVER_ASM_GEN_DST}
  DEPENDS ${SOLVER_ASM_GEN_SRC}
  COMMENT "Creating Assembly generator driver s-as-gen"
  )

ADD_CUSTOM_TARGET(solvercc      ALL DEPENDS ${SOLVER_CC_DST})
ADD_CUSTOM_TARGET(solversim     ALL DEPENDS ${SOLVER_RUN_SIM_DST})
ADD_CUSTOM_TARGET(solverrtlgen  ALL DEPENDS ${SOLVER_RTL_GEN_DST})
ADD_CUSTOM_TARGET(solverreadbin ALL DEPENDS ${SOLVER_READ_BIN_DST})
ADD_CUSTOM_TARGET(solverdbg     ALL DEPENDS ${SOLVER_DBG_DST})
ADD_CUSTOM_TARGET(solverasmgen  ALL DEPENDS ${SOLVER_ASM_GEN_DST})

INSTALL(PROGRAMS ${SOLVER_CC_DST}       DESTINATION bin)
INSTALL(PROGRAMS ${SOLVER_RUN_SIM_DST}  DESTINATION bin)
INSTALL(PROGRAMS ${SOLVER_RTL_GEN_DST}  DESTINATION bin)
INSTALL(PROGRAMS ${SOLVER_READ_BIN_DST} DESTINATION bin)
INSTALL(PROGRAMS ${SOLVER_DBG_DST}      DESTINATION bin)
INSTALL(PROGRAMS ${SOLVER_ASM_GEN_DST}  DESTINATION bin)

ADD_CUSTOM_TARGET(solver-py-files)
ADD_CUSTOM_COMMAND(
  TARGET solver-py-files
  COMMAND ${PYTHON_EXECUTABLE}
  ARGS ${SIMD-TOOLCHAIN_SOURCE_DIR}/scripts/python/utils/sys_utils.py
  copy-if-newer ${CMAKE_CURRENT_SOURCE_DIR} ${SIMD-TOOLCHAIN_BINARY_DIR}/lib/solver
  )
ADD_DEPENDENCIES(solversim solver-py-files)
ADD_DEPENDENCIES(solverrtlgen solver-py-files)
ADD_DEPENDENCIES(solverreadbin solver-py-files)
ADD_DEPENDENCIES(solverasmgen solver-py-files)
